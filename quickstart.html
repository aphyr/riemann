---
title: Riemann - Quickstart
layout: default
---
<style>
  body {
    background: #88ff00; /* Old browsers */
    background: -moz-radial-gradient(center, ellipse cover,  #88ff00 0%, #68ad00 100%); /* FF3.6+ */
    background: -webkit-gradient(radial, center center, 0px, center center, 100%, color-stop(0%,#88ff00), color-stop(100%,#68ad00)); /* Chrome,Safari4+ */
    background: -webkit-radial-gradient(center, ellipse cover,  #88ff00 0%,#68ad00 100%); /* Chrome10+,Safari5.1+ */
    background: -o-radial-gradient(center, ellipse cover,  #88ff00 0%,#68ad00 100%); /* Opera 12+ */
    background: -ms-radial-gradient(center, ellipse cover,  #88ff00 0%,#68ad00 100%); /* IE10+ */
    background: radial-gradient(ellipse at center,  #88ff00 0%,#68ad00 100%); /* W3C */
    filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#88ff00', endColorstr='#68ad00',GradientType=1 ); /* IE6-9 fallback on horizontal gradient */
  }
</style>

<div class="row">
  <h1>Ready? <span class="focus">Let's go!</span></h1>
</div>

<div class="row">
  <div class="twelvecol">
    <p class="callout">For this tutorial, you'll need a *nix system, Java,
    and Ruby.</p>
  </div>
</div>


</div><!-- main -->
<div class="light">
  
<div class="container">
  <div class="row">
    <div class="sixcol">
      <h2>Installing Riemann</h2>

<code><pre>wget <a href="http://aphyr.com/riemann/riemann-0.2.0.tar.bz2">http://aphyr.com/riemann/riemann-0.2.0.tar.bz2</a>
tar xvfj riemann-0.2.0.tar.bz2
cd riemann-0.2.0</pre></code>

      <p>Check the md5sum to verify the tarball:</p>
<code><pre>wget <a href="http://aphyr.com/riemann/riemann-0.2.0.tar.bz2.md5">http://aphyr.com/riemann/riemann-0.2.0.tar.bz2.md5</a>
md5sum -c riemann-0.2.0.tar.bz2.md5
</pre></code>

      <p>You can also install Riemann via <a
        href="https://forge.puppetlabs.com/garethr/riemann">Puppet</a> or <a href="https://github.com/garethr/riemann-vagrant">Vagrant</a>.</p>

      <p>Start the server</p>

      <code><pre>bin/riemann etc/riemann.config</pre></code>

      <p>Riemann is now listening for events. Install the Ruby client, utility
         package, and dashboard:</p>

      <code><pre>gem install riemann-client riemann-tools riemann-dash</pre></code>

      <p>Start the dashboard. If riemann-dash isn't in your path, check your
      rubygems bin directory.</p>

      <code><pre>riemann-dash</pre></code>

      <p>Point your web browser to <a
        href="http://localhost:4567/">http://localhost:4567/</a>. You'll see a
      big title and a quick overview of the control scheme in the bottom pane.
      At the top right is the current host your browser is connected to. At the
      top left is the pager, which shows your workspaces--like tabs, in a
      browser.</p>


      <p>Let's change the title into a Grid view. Click the title "Riemann",
      press "e" to edit, and change "Title" to "Grid". We need to choose a
      <i>query</i> to select specific states from the index. For starters,
      let's select <i>everything</i> by typing <code>true</code> in the query
      field. Hit "Apply" when you're ready.</p>

      <p>Right now the index is empty, so you won't see any events. Let's send
      some:</p>

      <code><pre>riemann-health</pre></code>

      <p>The riemann-health daemon is a little Ruby program that submits events
      about the state of your CPU, memory, load, and disks to a Riemann server.
      If you switch back to the dashboard, you'll see your local host's state
      appear. The Grid view organizes events according to their host and
      service. Color indicates state, and the shaded bars show metrics. You can
      hover over an event, like CPU, to see its description.</p>
    </div>

    <div class="sixcol last">
      <h2>Working with Clients</h2>

      <p>Now that Riemann is installed, let's try sending some of our own
         states through the Ruby client.</p>

<code><pre><span class="unfocus">$</span> irb -r riemann/client
<span class="unfocus">ruby-1.9.3 :001 &gt;</span> r = Riemann::Client.new
<span class="unfocus"> =&gt; #&lt;Riemann::Client ... &gt;</span></pre></code>

      <p>We can send events with <code>&lt;&lt;</code>. For example, let's log an HTTP request.</p>

    <code><pre><span class="unfocus">ruby-1.9.3 :002 &gt;</span> r &lt;&lt; { 
host: "www1", 
service: "http req", 
metric: 2.53, 
state: "critical", 
description: "Request took 2.53 seconds.", 
tags: ["http"]
}</pre></code>

      <p>On the dashboard, critical events (like the one we just submitted)
      show up in red. All of these fields are optional, by the way. The ruby
      client will assume your events come from the local hostname unless you
      pass <code>host: nil</code>.</p>

      <p>Now let's ask for all events that have a service beginning with
      "http".</p>

<code><pre><span class="unfocus">ruby-1.9.3 :003 &gt;</span> r['service =~ "http%"']
<span class="unfocus">[&lt;Riemann::Event time: 1330041937, 
state: "critical", 
service: "http req", 
host: "www1", 
description: "Request took 2.53 seconds.", 
tags: ["http"], 
ttl: 300.0, 
metric_f: 2.5299999713897705&gt;]</span></pre></code>

      <p>There's the event we submitted. You could send these events from Rack
      middleware to log every request to your app, or track exceptions. Riemann
      can be configured to calculate rates, averages, min/max, distributions,
      and more.</p>
      
      <h2>What next?</h2>
      
      <p>Riemann comes with a standard config that listens on the local ipv4
      interface and indexes all events, but that's just the the start. You can learn a little more about <a href="/concepts.html">Riemann core concepts</a>, and use <code>etc/riemann.config</code> as a guide for
      your own configuration. For examples of problems you can solve with
      Riemann, check out the <a href="howto.html">howto guide</a>.</p>

      <h2>Best Practices</h2>

      <p>Your clocks may be unsynchronized to varying degrees. In some places,
      Riemann uses the server clock as the authoritative time. In other cases,
      Riemann will use the timestamps on individual events. Clock
      desynchronization can lead to unusual consequences if you don't consider
      these effects carefully; we recommend using NTP to synchronize your
      clocks as closely as possible.</p>
    </div>
  </div>
</div>
